########################################################################################################################
## Django 自带模块导入
########################################################################################################################


########################################################################################################################
## 系统自带模块导入
########################################################################################################################
import urllib.request
import json

########################################################################################################################
## 自建模块导入
########################################################################################################################


########################################################################################################################
## 获取IP的地址
########################################################################################################################
def get_ip_location(ip):
    url = "http://ip.taobao.com/service/getIpInfo.php?ip="
    data = urllib.request.urlopen(url + ip).read().decode("utf-8")
    datadict=json.loads(data)

    for oneinfo in datadict:
        if "code" == oneinfo:
            if datadict[oneinfo] == 0:
                county = datadict["data"]["county"]
                if county != '内网IP':
                    country = datadict["data"]["country"]
                    provience = datadict["data"]["region"]
                    city = datadict["data"]["city"]
                    address = country +' '+ provience +' '+ city
                else:
                    address = 'Unknown'
                return address













